const gNET={ws:void 0,isHost:void 0,client_id:void 0,handlers:{},connect:(s,t,e="ws://jdev-gameserver.herokuapp.com/gnet/")=>{gNET.client_id=t,gNET.ws=new WebSocket(e+s),gNET.ws.onmessage=(s=>{const e=JSON.parse(s.data);"control/handshake"==e.type&&gNET.ws.send(JSON.stringify({type:"control/userid",data:{userID:t}})),"control/mode"==e.type&&(gNET.isHost=e.data.host),gNET.handlers[e.type]&&gNET.handlers[e.type](e)})},on:(s,t)=>{gNET.handlers[s]=t},send:(s,t)=>{t&&gNET.isHost?gNET.ws.send(JSON.stringify({type:void 0,destination:t,data:s})):gNET.ws.send(JSON.stringify(s))},broadcast:s=>{gNET.isHost&&gNET.ws.send(JSON.stringify({type:void 0,destination:"[{broadcast}]",data:s}))},local:s=>{gNET.client_id=s,gNET.ws={},gNET.isHost=!0,gNET.ws.onmessage=(t=>{const e=JSON.parse(t.data);"control/handshake"==e.type&&gNET.ws.send(JSON.stringify({type:"control/userid",data:{userID:s}})),"control/userid"==e.type&&gNET.ws.send(JSON.stringify({type:"control/mode",data:{host:!0}})),"control/mode"==e.type&&(gNET.isHost=e.data.host),gNET.handlers[e.type]&&gNET.handlers[e.type](e)}),gNET.ws.send=(s=>{JSON.parse(s).destination?(delete(s=JSON.parse(s)).destination,s.type="host/packet",gNET.ws.onmessage({data:JSON.stringify(s)})):gNET.ws.onmessage({data:JSON.stringify({type:"client/packet",data:JSON.parse(s),source:gNET.client_id})})}),gNET.ws.send(JSON.stringify({type:"control/handshake",data:{target:"local"}}))}};